{"version":3,"sources":["../../src/controllers/monitoringAreaController.js"],"names":["MonitoringAreaController","ctx","data","request","body","info","msg","findOne","ip","fields","isExit","monitoringArea","save","err","name","id","params","findByIdAndRemove","exec","result","error","update","find"],"mappings":";;;;;;qjBAAA;;;;;AAGA;;;;AACA;;;;;;;;;;IAEMA,wB;;;;;;;;gGAC8BC,G;;;;;;AACtBC,oC,GAAOD,IAAIE,OAAJ,CAAYC,I;;AACzB,iDAAOC,IAAP,CAAYH,IAAZ;;oCACIA,I;;;;;iEAAaD,IAAIG,IAAJ,GAAS,EAAEE,KAAK,SAAP,E;;;;uCACL,yBAAoBC,OAApB,CAA4B,EAACC,IAAGN,KAAKO,MAAL,CAAYD,EAAhB,EAA5B,C;;;AAAfE,sC;;AACN,iDAAOL,IAAP,CAAYK,MAAZ;;qCACGA,M;;;;;iEAAeT,IAAIG,IAAJ,GAAS,EAAEE,KAAK,WAAP,E;;;AAEvBK,8C,GAAiB,6BAAwBT,KAAKO,MAA7B,C;;AACrB,iDAAOJ,IAAP,CAAYM,cAAZ;AACIL,mC,GAAM,E;;AACVK,+CAAeC,IAAf,CAAoB,UAAUC,GAAV,EAAcF,cAAd,EAA8B;AAC9C,wCAAG,CAACE,GAAJ,EAAS;AACLP,8CAAM,WAAUK,eAAeG,IAAzB,GAA+B,IAArC;AACH,qCAFD,MAEK;AACDR,8CAAMO,GAAN;AACH;AACJ,iCAND;;iEAQOZ,IAAIG,IAAJ,GAAW,EAACE,KAAIA,GAAL,EAASJ,MAAKS,cAAd,E;;;;;;;;;;;;;;;;;;;kGAGaV,G;;;;;;AACvBc,kC,GAAOd,IAAIe,M,CAAXD,E;;AACR,iDAAOV,IAAP,CAAYU,EAAZ;;uCACqB,yBAAoBE,iBAApB,CAAsCF,EAAtC,EAA0CG,IAA1C,E;;;AAAfC,sC;;oCACFA,M;;;;;kEAAelB,IAAImB,KAAJ,GAAU,EAACd,KAAK,WAAN,E;;;kEACtBL,IAAIG,IAAJ,GAAW,EAACE,KAAI,UAAL,EAAgBJ,MAAKiB,MAArB,E;;;;;;;;;;;;;;;;;;;kGAGWlB,G;;;;;;AACvBC,oC,GAAOD,IAAIE,OAAJ,CAAYC,I;;AACzB,iDAAOC,IAAP,CAAYH,IAAZ;;uCACqB,yBAAoBmB,MAApB,CAA2BnB,IAA3B,EAAgC,EAACa,IAAGb,KAAKa,EAAT,EAAhC,EAA8CG,IAA9C,E;;;AAAfC,sC;;oCACFA,M;;;;;kEAAelB,IAAImB,KAAJ,GAAU,EAACd,KAAK,WAAN,E;;;kEACtBL,IAAIG,IAAJ,GAAW,EAACE,KAAI,UAAL,EAAgBJ,MAAKiB,MAArB,E;;;;;;;;;;;;;;;;;;;kGAGWlB,G;;;;;;;uCACR,yBAAoBqB,IAApB,GAA2BJ,IAA3B,E;;;AAAfC,sC;;oCACFA,M;;;;;kEAAelB,IAAIG,IAAJ,GAAS,EAACE,KAAK,WAAN,E;;;kEACrBL,IAAIG,IAAJ,GAAW,EAACE,KAAI,QAAL,EAAcJ,MAAKiB,MAAnB,E;;;;;;;;;;;;;;;;;;;kGAEAlB,G;;;;;;AACVc,kC,GAAOd,IAAIe,M,CAAXD,E;;uCACa,yBAAoBR,OAApB,CAA4B,EAACQ,IAAGA,EAAJ,EAA5B,EAAqCG,IAArC,E;;;AAAfC,sC;;oCACFA,M;;;;;kEAAelB,IAAIG,IAAJ,GAAW,EAACE,KAAK,WAAN,E;;;kEACvBL,IAAIG,IAAJ,GAAW,EAACE,KAAI,QAAL,EAAcJ,MAAKiB,MAAnB,E;;;;;;;;;;;;;;;;;;;;;kBAKXnB,wB","file":"monitoringAreaController.js","sourcesContent":["/**\n * Created by chen on 17-8-23.\n */\nimport logger from '../logger';\nimport MonitoringAreaModel from '../models/monitoringArea.model';\n\nclass MonitoringAreaController {\n    static async add_monitoringArea(ctx){\n        const data = ctx.request.body;\n        logger.info(data);\n        if(!data) return ctx.body={ msg: '发送数据失败!' };\n        const isExit = await MonitoringAreaModel.findOne({ip:data.fields.ip});\n        logger.info(isExit);\n        if(isExit) return ctx.body={ msg: '该监控区域已添加!' };\n\n        let monitoringArea = new MonitoringAreaModel(data.fields);\n        logger.info(monitoringArea);\n        let msg = '';\n        monitoringArea.save(function (err,monitoringArea) {\n            if(!err) {\n                msg = '添加监控区域'+ monitoringArea.name +'成功';\n            }else{\n                msg = err;\n            }\n        });\n\n        return ctx.body = {msg:msg,data:monitoringArea};\n    }\n\n    static async delete_monitoringArea(ctx) {\n        const { id } = ctx.params;\n        logger.info(id);\n        const result = await MonitoringAreaModel.findByIdAndRemove(id).exec();\n        if(!result) return ctx.error={msg: '删除监控区域失败!'};\n        return ctx.body = {msg:'删除监控区域成功',data:result};\n    }\n\n    static async edit_monitoringArea(ctx){\n        const data = ctx.request.body;\n        logger.info(data);\n        const result = await MonitoringAreaModel.update(data,{id:data.id}).exec();\n        if(!result) return ctx.error={msg: '修改监控区域失败!'};\n        return ctx.body = {msg:'修改监控区域成功',data:result};\n    }\n\n    static async find_monitoringArea(ctx){\n        const result = await MonitoringAreaModel.find().exec();\n        if(!result) return ctx.body={msg: '没有找到监控区域!'};\n        return ctx.body = {msg:'查询监控区域',data:result};\n    }\n    static async find_one(ctx){\n        const { id } = ctx.params;\n        const result = await MonitoringAreaModel.findOne({id:id}).exec();\n        if(!result) return ctx.body = {msg: '没有找到监控区域!'};\n        return ctx.body = {msg:'查询监控区域',data:result};\n    }\n\n}\n\nexport default MonitoringAreaController;"]}